<textarea cols=30 rows=15 id=B1>
*星号为注释行，注释不能含英文逗号
*每组第一个地标前加m和空格
*每组第二个加上l和空格
*每组最后一个加上r和空格
*小岛一
m 161.341,-79.951,
l 161.681,-79.964,
162.48,-79.924,
163.639,-79.782,
164.451,-79.565,
164.724,-79.229,
164.359,-79,
163.63,-78.784,
162.835,-78.786,
162.338,-79.003,
162.145,-79.339,
161.443,-79.58,
160.835,-79.735,
160.8,-79.876,
r 161.341,-79.951,

*小岛二
m 126.185,-73.971,
l 126.323,-73.977,
127.101,-73.805,
127.39,-73.603,
127.319,-73.313,
126.612,-73.095,
125.868,-73.256,
125.803,-73.372,
125.494,-73.402,
124.391,-73.59,
124.347,-73.683,
124.657,-73.774,
125.354,-73.873,
r 126.185,-73.971,

*小岛三
m 109.001,-74.806,
l 108.96,-74.749,
109.69,-74.595,
109.956,-74.483,
109.742,-74.297,
110.196,-74.001,
109.828,-73.789,
109.47,-73.722,
109.104,-73.818,
108.945,-73.988,
108.477,-74.058,
108.141,-74.242,
108.288,-74.545,
r 109.001,-74.806,

*小岛四
m 95.258,-72.142,
l 95.321,-72.205,
95.789,-72.265,
96.861,-72.205,
98.132,-72.167,
99.178,-72.131,
100.541,-72.048,
101.018,-71.996,
101.066,-71.856,
100.628,-71.742,
100.373,-71.837,
100.266,-71.754,
99.337,-71.749,
98.12,-71.813,
97.779,-71.907,
97.347,-71.898,
96.633,-71.837,
95.917,-71.885,
r 95.258,-72.142,

*小岛五
m 71.291,-72.222,
l 71.315,-72.163,
71.636,-72.099,
72.516,-72.203,
72.996,-72.001,
73.882,-71.693,
74.4,-71.826,
74.594,-72.075,
75.579,-71.998,
76.689,-71.798,
77.627,-71.353,
77.696,-70.987,
77.272,-71.042,
76.534,-71.285,
76.375,-71.087,
75.556,-71.077,
74.895,-71.192,
74.044,-71.259,
72.941,-71.108,
72.187,-70.927,
71.953,-70.536,
71.943,-70.008,
72.483,-69.411,
73.046,-68.892,
72.337,-68.796,
71.858,-68.621,
71.516,-68.652,
70.457,-68.56,
70.518,-68.746,
70.769,-69.029,
70.466,-69.3,
70.429,-69.753,
69.91,-70.013,
69.554,-70.551,
69.756,-70.948,
69.496,-71.444,
69.317,-71.942,
69.642,-72.335,
70.409,-72.597,
71.538,-72.796,
72.449,-72.815,
73.143,-72.625,
72.989,-72.437,
72.253,-72.309,
71.766,-72.341,
r 71.291,-72.222,

*小岛六
m 43.493,-80.011,
l 42.992,-80.246,
44.149,-80.553,
46.188,-80.811,
48.862,-80.979,
50.95,-81.016,
52.757,-80.917,
53.932,-80.577,
54.013,-80.386,
54.221,-79.885,
54.227,-79.309,
53.681,-78.692,
53.104,-78.15,
52.819,-77.774,
51.889,-77.632,
50.23,-77.67,
48.655,-77.783,
47.463,-78.063,
46.792,-78.42,
45.651,-78.993,
44.505,-79.54,
r 43.493,-80.011,

*本岛
m -107.284,-66.007,
l -107.795,-66.19,
-108.876,-66.538,
-109.624,-66.264,
-110.612,-66.21,
-111.233,-65.822,
-111.854,-65.453,
-113.208,-65.163,
-114.183,-65.615,
-115.042,-65.818,
-116.539,-65.986,
-117.05,-66.456,
-118.268,-66.798,
-119.173,-66.596,
-121.03,-66.491,
-123.457,-66.203,
-124.477,-66.424,
-124.839,-66.243,
-123.948,-65.755,
-124.725,-65.608,
-126.632,-66.063,
-128.635,-66.607,
-130.347,-66.193,
-132.58,-65.885,
-135.795,-65.831,
-136.636,-65.791,
-138.216,-66.151,
-139.742,-66.394,
-140.828,-66.593,
-141.712,-66.426,
-142.828,-66.331,
-143.455,-66.604,
-144.522,-66.918,
-145.805,-67.229,
-146.743,-67.688,
-147.437,-68.142,
-147.982,-68.057,
-150.203,-68.168,
-151.211,-68.233,
-150.211,-68.531,
-149.931,-68.713,
-150.952,-68.774,
-152.096,-68.656,
-153.894,-68.787,
-154.679,-68.561,
-154.396,-68.4,
-154.669,-68.376,
-155.127,-68.475,
-155.358,-68.642,
-156.302,-68.872,
-158.139,-69.15,
-159.628,-69.386,
-160.631,-69.804,
-161.902,-70.483,
-163.557,-70.68,
-165.36,-70.629,
-166.794,-70.705,
-167.916,-71.072,
-169.639,-71.508,
-170.37,-71.895,
-169.864,-72.428,
-168.114,-72.822,
-166.541,-73.523,
-164.462,-74.338,
-162.205,-75.022,
-161.761,-75.777,
-162.915,-76.627,
-162.487,-77.056,
-163.185,-77.351,
-163.407,-77.718,
-164.879,-77.912,
-164.652,-78.214,
-162.193,-78.311,
-160.45,-78.763,
-160.502,-79.643,
-161.324,-80.995,
-163.779,-82.152,
-166.665,-83.054,
-169.912,-83.838,
-177.042,-84.351,
179.186,-84.536,
175.623,-84.863,
171.388,-85.373,
167.234,-85.38,
162.497,-85.333,
157.635,-85.556,
152.455,-85.782,
147.435,-85.741,
145.748,-85.393,
148.422,-84.839,
153.514,-84.308,
156.553,-83.895,
156.405,-83.59,
155.404,-82.817,
156.026,-82.238,
156.525,-81.671,
155.885,-81.21,
153.491,-80.913,
151.01,-80.858,
147.909,-80.78,
146.651,-80.619,
147.266,-80.304,
149.729,-80.185,
151.995,-80.092,
153.708,-79.803,
154.268,-79.455,
156.492,-78.552,
158.522,-77.832,
159.099,-77.339,
157.665,-77.013,
155.874,-76.932,
154.024,-77.158,
152.775,-77.543,
150.658,-77.717,
148.661,-77.623,
146.708,-77.353,
145.764,-77.004,
146.277,-76.742,
146.941,-76.416,
146.218,-76.16,
143.799,-75.791,
141.178,-75.523,
139.374,-75.106,
137.117,-74.726,
135.462,-74.578,
133.343,-74.528,
130.404,-74.72,
125.56,-74.561,
121.944,-74.512,
119.35,-74.553,
117.877,-74.495,
115.749,-74.516,
113.203,-74.683,
111.959,-75.101,
108.328,-75.322,
106.119,-75.044,
104.341,-74.991,
102.712,-75.212,
101.081,-75.33,
100.528,-74.886,
100.901,-73.865,
102.052,-73.444,
101.519,-73.269,
100.019,-73.294,
94.848,-73.431,
92.42,-73.302,
89.834,-73.462,
89.061,-72.938,
88.204,-72.759,
86.5,-73.083,
84.856,-72.988,
83.463,-73.295,
81.32,-73.669,
80.676,-73.574,
80.744,-73.045,
80.018,-72.942,
79.713,-73.259,
77.669,-73.542,
74.523,-73.385,
71.128,-73.147,
69.274,-73.02,
68.524,-72.511,
68.578,-71.39,
68.928,-70.274,
69.947,-69.603,
70.01,-69.157,
68.438,-68.022,
68.51,-67.504,
67.942,-66.92,
66.703,-66.424,
66.703,-66.175,
65.332,-65.378,
65.189,-64.808,
62.794,-64.436,
61.082,-63.726,
58.864,-63.016,
57.302,-62.593,
55.665,-62.797,
55.737,-62.977,
56.432,-62.953,
56.846,-63.059,
57.303,-63.307,
57.908,-63.311,
58.634,-63.433,
58.926,-63.817,
59.136,-64.197,
59.673,-64.297,
61.095,-64.488,
61.925,-64.897,
62.674,-65.069,
64.007,-65.639,
65.14,-66.28,
65.26,-66.846,
65.628,-67.429,
65.915,-68.097,
65.713,-68.268,
64.822,-67.775,
64.118,-67.748,
63.831,-68.348,
63.821,-69.261,
62.988,-70.216,
61.993,-70.941,
62.112,-71.844,
61.261,-72.617,
61.164,-73.061,
62.377,-73.828,
63.023,-74.988,
64.276,-75.812,
67.177,-76.574,
68.794,-77.105,
68.47,-77.66,
68.334,-78.028,
69.726,-78.341,
72.712,-78.233,
75.557,-77.614,
75.695,-76.837,
76.697,-76.81,
78.561,-76.804,
78.887,-76.863,
81.015,-76.974,
81.919,-76.894,
82.57,-77.025,
81.905,-77.696,
82.167,-78.091,
81.192,-78.505,
81.543,-78.748,
82.709,-78.969,
82.667,-79.314,
80.357,-79.498,
77.545,-79.885,
73.461,-80.421,
69.621,-80.8,
66.107,-81.283,
62.527,-81.431,
56.306,-81.75,
53.407,-81.725,
50.207,-81.545,
47.746,-81.77,
44.786,-81.787,
40.586,-81.484,
38.082,-81.087,
36.211,-80.679,
34.489,-80.307,
32.766,-80.147,
30.583,-80.134,
28.933,-79.947,
28.318,-79.729,
29.08,-79.475,
30.378,-79.318,
31.999,-79.215,
33.727,-79.16,
35.375,-78.943,
36.175,-78.67,
35.375,-78.943,
36.482,-78.139,
35.714,-77.74,
34.42,-77.508,
32.971,-77.266,
31.959,-76.891,
30.694,-76.647,
27.552,-76.346,
25.788,-75.483,
24.694,-74.946,
23.399,-74.561,
21.32,-74.093,
19.812,-73.832,
19.135,-73.445,
18.565,-73.012,
17.237,-72.952,
15.581,-72.985,
17.237,-72.952,
13.419,-72.755,
12.146,-72.384,
11.568,-71.963,
11.684,-71.608,
12.198,-71.271,
11.96,-71.077,
10.554,-70.741,
9.911,-70.807,
9.124,-71.087,
8.338,-71.109,
7.489,-70.768,
6.133,-70.642,
4.399,-70.624,
2.913,-70.313,
1.844,-69.981,
0.637,-69.862,
-0.276,-70.11,
-0.467,-70.411,
-1.019,-70.756,
-1.647,-70.779,
-2.32,-70.487,
-2.954,-70.239,
-3.742,-70.196,
-4.787,-70.463,
-5.584,-70.521,
-6.361,-70.337,
-7.406,-70.227,
-8.868,-70.315,
-10.496,-70.499,
-11.9,-70.443,
-13.866,-70.325,
-15.283,-70.233,
-16.445,-70.243,
-17.8,-70.284,
-18.947,-70.267,
-20.451,-70.11,
-20.918,-70.383,
-21.644,-70.68,
-22.743,-70.69,
-24.013,-70.489,
-25.322,-70.359,
-27.056,-70.364,
-28.329,-70.208,
-29.482,-69.937,
-30.773,-69.673,
-32.194,-69.698,
-33.277,-69.608,
-34.007,-69.328,
-34.263,-68.841,
-34.069,-68.148,
-34.625,-68.109,
-35.39,-68.523,
-36.229,-69.028,
-36.729,-69.495,
-37.272,-69.678,
-38.71,-69.445,
-40.047,-68.761,
-42.181,-68.102,
-43.721,-67.703,
-45.054,-67.369,
-45.791,-67.457,
-46.286,-67.664,
-46.826,-67.688,
-47.847,-67.442,
-47.747,-67.044,
-48.964,-67.005,
-50.073,-67.161,
-50.281,-67.083,
-50.316,-66.911,
-50.571,-66.831,
-50.63,-66.668,
-49.96,-66.533,
-50.146,-66.376,
-51.47,-65.788,
-52.405,-65.81,
-53.155,-65.697,
-54.232,-65.647,
-55.105,-65.909,
-56.288,-66.212,
-56.896,-66.344,
-56.528,-66.549,
-55.782,-66.924,
-55.838,-67.093,
-56.593,-67.175,
-57.12,-67.06,
-57.111,-66.805,
-57.884,-66.92,
-58.798,-66.998,
-58.383,-67.161,
-58.654,-67.31,
-60.49,-67.236,
-62.262,-67.39,
-65.599,-67.497,
-67.104,-67.754,
-68.381,-67.503,
-69.632,-67.398,
-70.344,-67.266,
-70.922,-66.998,
-71.499,-67.115,
-71.453,-67.631,
-70.244,-68.245,
-69.173,-68.544,
-68.726,-69.156,
-69.138,-69.32,
-68.505,-69.586,
-68.399,-70.085,
-69.709,-70.382,
-71.248,-70.429,
-72.018,-70.048,
-73.813,-69.741,
-74.495,-69.552,
-74.917,-69.183,
-75.137,-69.129,
-75.836,-69.28,
-76.797,-69.146,
-76.963,-68.518,
-77.822,-68.265,
-80.227,-67.938,
-82.246,-66.768,
-82.621,-66.634,
-82.912,-66.764,
-82.99,-67.133,
-83.83,-67.23,
-84.839,-67.25,
-85.579,-67.039,
-86.136,-66.797,
-86.304,-66.543,
-86.284,-65.872,
-86.643,-65.64,
-87.37,-65.656,
-87.875,-65.906,
-88.701,-66.5,
-89.79,-66.626,
-91.5,-66.361,
-94.036,-66.31,
-95.229,-66.425,
-96.438,-66.392,
-96.845,-66.061,
-96.622,-65.259,
-97.038,-65.03,
-97.702,-64.993,
-97.996,-65.287,
-97.52,-65.835,
-98.475,-66.091,
-99.138,-66.083,
-99.338,-65.53,
-99.812,-65.391,
-101.61,-65.601,
-103.51,-65.486,
-105.311,-65.911,
r -107.284,-66.007
</textarea>
<textarea cols=80 rows=15 id=B2>
</textarea><br>

宽<input type=text value="4200" size=10 id=Ca> 原表东经<input type=text value="正" size=10 id=Cj><br>
高<input type=text value="2100" size=10 id=Cb> 原表北纬<input type=text value="正" size=10 id=Cw><br>
J小数位<input type=text value="0" size=10 id=Cn1> W小数位<input type=text value="0" size=10 id=Cn2><br>
取样步长<input type=text value="10" size=10 id=Cbc><br>
<input type=button onclick="zhuan()" value="确定">

<script language=javascript>
Number.prototype.toFixed=function(m){ //IE6.0的toFixed()有Bug,所以重写
  var n=this, f='', p=Math.pow(10,m); //p为10进制移位量;
  if(n<0) n = -n, f = '-';   //把负数转为正数
  var a=Math.floor(n),b=n-a; //分离整数与小数
  b = Math.round(b*p );      //移位并四舍五入
  if(b>=p) a++,b-=p;         //进位
  if(m) b = '.'+(p+b+'').substr(1,m); //小数部分左边补0
  else b = '';
  return f+a+b;
};
function zhuan(){
 var s=B1.value;
 s=s.replace(/(\r\n)|( )/g,',');
 s=s.replace(/,+/g,',');
 s=s.split(',');

 var a=Ca.value-0, Aj=Cj.value, b=Cb.value-0, Aw=Cw.value, step=Math.floor(Cbc.value-0);
 var n1 = Cn1.value-0, n2 = Cn2.value-0;
 var i,k=0, p='', g, J,W;
 if(step<=0) step=1;
 for(i=0;i<s.length;i++) if(s[i].substr(0,1)=='*') break;
 for(;i<s.length;i++){
   if(s[i].substr(0,1)=='*') continue;
   if(s[i]=='') break;
   g=',';
   if(s[i]=='m') p+=' m', g=' ', i++,k=0; //moveto
   if(s[i]=='l') p+=' l', g=' ', i++,k=0; //lineto
   if(s[i]=='r')                 i++,k=0; //曲线结束标记
   J=a*s[i]  /360; if(Aj=='负') J=-J; //经放缩
   W=b*s[i+1]/180; if(Aw=='正') W=-W; //纬放缩
   if(!k||k%step==step-1) p += g + ((J+a)%a).toFixed(n1) +','+ (W+b/2).toFixed(n2);
   k++, i++;
 }
 B2.value="  +'"+p.substr(1,p.length-1)+" '";
}


</script>